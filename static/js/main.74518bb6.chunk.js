(this.webpackJsonptaestitrack=this.webpackJsonptaestitrack||[]).push([[0],{105:function(e,t,a){e.exports=a(194)},106:function(e,t,a){},193:function(e,t){window.utils={randStr:function(e){for(var t="",a="abcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},keygen:function(){return Date.now()+"-"+window.utils.randStr(10)}}},194:function(e,t,a){"use strict";a.r(t);a(106),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(107),a(108),a(109),a(110),a(135),a(136);var n=a(1),r=a.n(n),l=a(18),o=a.n(l),s=a(33),i=["TOGGLE_SIDENAV","HIDE_SIDENAV"],c={TOGGLE_SIDENAV:function(e){return e.show_sidenav_onsmallscreen=!e.show_sidenav_onsmallscreen,e},HIDE_SIDENAV:function(e){return e.show_sidenav_onsmallscreen=!1,e}};function u(e){return JSON.parse(JSON.stringify(e))}function d(e){return i.indexOf(e)>-1}var m=a(63),p=["TASK_ADD","TASK_START","TASK_DONE"],h={TASK_ADD:function(e,t){delete t.type;var a={description:t.description,estimate:t.estimate,status:"new",interval:0,created_at:parseInt(Date.now()/1e3)};return[].concat(Object(m.a)(e),[a])}};function k(e){return p.indexOf(e)>-1}function f(e){return JSON.parse(JSON.stringify(e))}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(k(t.type)){var a=f(e);return h[t.type](a,t)}return e}var b=["PLAYBOOK_HYDRATE","PLAYBOOK_ADD","PLAYBOOK_FILTER","TASK_ADD","PLAYBOOK_UPDATE"],y={PLAYBOOK_ADD:function(e,t){var a={description:t.description,title:t.title,status:"new",tasks:[],created_at:parseInt(Date.now()/1e3)};return[].concat(Object(m.a)(e),[a])},PLAYBOOK_FILTER:function(e,t){return e},TASK_ADD:function(e,t){return e.map((function(e){return e.id===t.playbookId&&(e.tasks=v(e.tasks,t)),e}))},PLAYBOOK_HYDRATE:function(e,t){return t.data},PLAYBOOK_UPDATE:function(e,t){e[t.playbook.key]&&(e[t.playbook.key]=t.playbook);return e}};function E(e){return b.indexOf(e)>-1}function g(e){return JSON.parse(JSON.stringify(e))}var w=["CURRENT_PLAYBOOK","SET_ACTIVE_TASK"],T={CURRENT_PLAYBOOK:function(e,t){return e.currentPlaybook=t.playbook.key,e},SET_ACTIVE_TASK:function(e,t){return e.activeTask=t.activeTask,e}};function O(e){return JSON.parse(JSON.stringify(e))}function D(e){return w.indexOf(e)>-1}var B=["REFRESH_LOGS"],S={REFRESH_LOGS:function(e,t){return t.logs}};function C(e){return B.indexOf(e)>-1}function M(e){return JSON.parse(JSON.stringify(e))}var N=Object(s.c)({dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show_sidenav_onsmallscreen:!1},t=arguments.length>1?arguments[1]:void 0,a=u(e);return d(t.type)?c[t.type](a,t):a},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentPlaybook:null,activeTask:null},t=arguments.length>1?arguments[1]:void 0,a=O(e);return D(t.type)?T[t.type](a,t):a},playbooks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=g(e);if(E(t.type))return y[t.type](a,t);for(var n in a)a[n].tasks=v(a[n].tasks,t);return a},logs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{logs:{}},t=arguments.length>1?arguments[1]:void 0,a=M(e);return C(t.type)?S[t.type](a,t):a}}),j=a(101),P=a(21),L=a(11),A=a(7),I=a(8),_=a(10),F=a(9),R=a(19),x=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={},n}return Object(I.a)(a,[{key:"_bind",value:function(e){var t=this;e&&(e.constructor!==Array?this[e].constructor!==Function||(this[e]=this[e].bind(this)):e.map((function(e){t[e]=t[e].bind(t)})))}}]),a}(r.a.Component),z=a(2),J=a(102),U=a.n(J),G=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(){return Object(A.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){var e=function(e){return e<10?"0"+e:e},t=parseInt(this.props.timeInSeconds),a=this.props.color||"green";t<0&&(a="red",t*=-1);var n=parseInt(t/3600),l=parseInt(t%3600/60),o=parseInt(t%3600%60);return this.props.humanize?r.a.createElement("span",{style:{display:"inline-block",color:a}},U()(1e3*t)):r.a.createElement("div",{style:{display:"inline-block",color:a}},r.a.createElement("span",{className:"time-hrs"},e(n)),r.a.createElement("span",{className:"time-sep"},":"),r.a.createElement("span",{className:"time-min"},e(l)),r.a.createElement("span",{className:"time-sep"},":"),r.a.createElement("span",{className:"time-sec"},e(o)))}}]),a}(r.a.Component),K=a(57),V=a.n(K),Y=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(){return Object(A.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){var e=new Date(this.props.milliseconds);return e=V()(e),r.a.createElement("div",{style:{display:"inline-block"}},e.format("DD/MM/YY hh:mmA"))}}]),a}(r.a.Component),H=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(){return Object(A.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"renderLogsTable",value:function(){var e=this.props.completedTasks;return r.a.createElement(z.Table,{hover:!0,responsive:!0,scrollY:!0,maxHeight:"50vh"},r.a.createElement(z.TableHead,{color:"pink darken-3",textWhite:!0},r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Playbook Title"),r.a.createElement("th",null,"Task Title"),r.a.createElement("th",null,"Created On"),r.a.createElement("th",null,"Started On"),r.a.createElement("th",null,"Completed On"),r.a.createElement("th",null,"Estimate"),r.a.createElement("th",null,"Actual"),r.a.createElement("th",null,"Deviation"))),r.a.createElement(z.TableBody,null,function(){var t=[],a=1;for(var n in e){var l=e[n];t.push(r.a.createElement("tr",null,r.a.createElement("th",null,a++),r.a.createElement("th",null,l.playbook),r.a.createElement("th",null,l.task),r.a.createElement("th",null,r.a.createElement(Y,{milliseconds:l.created_at})),r.a.createElement("th",null,r.a.createElement(Y,{milliseconds:l.started_at})),r.a.createElement("th",null,r.a.createElement(Y,{milliseconds:l.completed_at})),r.a.createElement("th",null,r.a.createElement(G,{color:"black",timeInSeconds:l.estimate})),r.a.createElement("th",null,r.a.createElement(G,{color:"black",timeInSeconds:l.duration})),r.a.createElement("th",null,r.a.createElement(G,{timeInSeconds:parseInt(l.estimate)-parseInt(l.duration)}))))}return t}()))}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,null,r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement(z.MDBJumbotron,null,r.a.createElement("h1",null,"Completed Tasks"),this.renderLogsTable()))))}}]),a}(x),W=Object(R.b)((function(e){return{completedTasks:e.logs&&e.logs.completedTasks||null}}),null)(H),q=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state.form={},n}return Object(I.a)(a,[{key:"handleChange",value:function(e){var t=this.state.form;t[e.target.name]=e.target.value,this.setState({form:t})}}]),a}(x),X=function(){function e(){Object(A.a)(this,e)}return Object(I.a)(e,null,[{key:"add",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return null};window.FB.addNewPlayBook(e,t,(function(e){return setTimeout((function(){a(e)}),0)}))}},{key:"hydrate",value:function(e){return{type:"PLAYBOOK_HYDRATE",data:e}}},{key:"update",value:function(e){return{type:"PLAYBOOK_UPDATE",playbook:e}}}]),e}(),$=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e))._bind(["onSubmit","handleChange"]),n}return Object(I.a)(a,[{key:"onSubmit",value:function(e){var t=this;return e.preventDefault(),this.props.submit&&this.props.submit(this.state.form,(function(e){return t.props.history.push("/playbook/".concat(e.key))}))}},{key:"handleChange",value:function(e){var t=this.state.form;t[e.target.name]=e.target.value,this.setState({form:t})}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,null,r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement(z.MDBJumbotron,null,r.a.createElement("h2",null,"New Playbook"),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement(z.MDBInput,{label:"Playbook Title",name:"title",onChange:this.handleChange}),r.a.createElement(z.MDBInput,{label:"Playbook Description",name:"description",onChange:this.handleChange}),r.a.createElement(z.MDBBtn,{color:"green",onClick:this.onSubmit},"Create New Playbook"))))))}}]),a}(q),Q=Object(R.b)(null,(function(e){return{submit:function(e,t){X.add(e.title,e.description,t)}}}))(Object(L.o)($)),Z=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(){var e;Object(A.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).loadPlaybook=function(t){return function(){e.props.launchPlaybook(t,(function(){return e.props.history.push("/playbook/".concat(t.key))}))}},e}return Object(I.a)(a,[{key:"deletePlaybook",value:function(e){return function(t){t.stopPropagation(),window.FB.removePlaybook(e)}}},{key:"renderList",value:function(){var e=this,t=null;return this.props.playbooks&&(t=Object.keys(this.props.playbooks).map((function(t){var a=e.props.playbooks[t],n=0,l=0,o=0;if(a.tasks){var s=Object.keys(a.tasks);s.forEach((function(e){var t=a.tasks[e];"done"===t.status&&n++,l+=t.estimate})),o=s.length}return function(t,a,n,l,o){return r.a.createElement("div",{className:"card playbook-card",key:t,onClick:e.loadPlaybook(o),style:{cursor:"pointer"}},r.a.createElement("div",{className:"playbook-card-title"},o.title),r.a.createElement("div",{className:"playbook-card-description"},o.description),r.a.createElement("div",{className:"playbook-card-text"},"Contains ",a," tasks with total estimated time of ",K.duration(l,"second").humanize(),". ",n," tasks are already completed."),r.a.createElement("div",{className:"playbook-card-delete"},r.a.createElement("a",{onClick:e.deletePlaybook(t)},r.a.createElement(z.MDBIcon,{className:"delete link-icon",icon:"trash"}))))}(t,o,n,l,a)}))),r.a.createElement("div",{className:"playbook-list"},t)}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,null,r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement("h1",null,"Playbooks"),this.renderList())))}}]),a}(x),ee=Object(R.b)((function(e){return{playbooks:e.playbooks}}),(function(e){return{launchPlaybook:function(t,a){e({type:"CURRENT_PLAYBOOK",playbook:t}),a()}}}))(Object(L.o)(Z)),te=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).updateRemainingTime=function(e){var t=n.props.activeTask&&n.props.activeTask.estimate-a.getTimeTaken(n.props.activeTask);n.setState({remainingTime:t})},n.state={remainingTime:0},n._bind(["pause","done"]),n.timerId=null,n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.timerId=setInterval(this.updateRemainingTime,1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerId)}},{key:"pause",value:function(){window.FB.pauseTask(this.props.playbook,this.props.activeTask,this.componentWillUnmount)}},{key:"done",value:function(){window.FB.doneWithTask(this.props.playbook,this.props.activeTask,this.componentWillUnmount)}},{key:"render",value:function(){var e=this.props.activeTask,t=this.props.playbook;return t&&e?r.a.createElement(z.MDBContainer,{fluid:!0},r.a.createElement(z.MDBRow,{middle:!0,className:"active-task"},r.a.createElement(z.MDBCol,{size:"2",className:"active-task playbook-title"},"Playbook : ",t.title),r.a.createElement(z.MDBCol,{size:"8"},r.a.createElement(z.MDBRow,{top:!0},r.a.createElement(z.MDBCol,{size:"12",className:"active-task active-timer"},r.a.createElement(G,{timeInSeconds:this.state.remainingTime}))),r.a.createElement(z.MDBRow,{bottom:!0},r.a.createElement(z.MDBCol,{size:"12",className:"active-task title"},e.title))),r.a.createElement(z.MDBCol,{size:"2"},r.a.createElement(z.MDBBtn,{color:"cyan",size:"sm",onClick:this.pause},r.a.createElement(z.MDBIcon,{icon:"pause"})),r.a.createElement(z.MDBBtn,{color:"green",size:"sm",onClick:this.done},r.a.createElement(z.MDBIcon,{icon:"stop"}))))):null}}],[{key:"getTimeTaken",value:function(e){var t=0;if(e.laps)for(var a in e.laps){var n=e.laps[a];n.end&&n.start&&(t+=n.end-n.start),!1===n.end&&n.start&&(t+=1e3*window.APP_GLOBALS.TIMESTAMP-n.start)}return t/1e3}}]),a}(x),ae=Object(R.b)((function(e){var t=null,a=null;if(e.app.activeTask&&e.playbooks[e.app.activeTask.playbook]){var n=e.app.activeTask.task,r=e.app.activeTask.playbook;(t=e.playbooks[r].tasks[n]).key=n,a=e.playbooks[r]}return{activeTask:t,playbook:a}}),(function(e){return{}}))(te),ne=a(38),re=function(){function e(){Object(A.a)(this,e)}return Object(I.a)(e,null,[{key:"toggleSideNav",value:function(){return{type:"TOGGLE_SIDENAV"}}},{key:"hideSideNav",value:function(){return{type:"HIDE_SIDENAV"}}}]),e}(),le=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={collapse:!1},n}return Object(I.a)(a,[{key:"render",value:function(){return this.props.activeTask&&this.props.activeTask.task||window.innerWidth<1200?r.a.createElement(z.Navbar,{className:"flexible-navbar",light:!0,expand:"md",scrolling:!0},r.a.createElement(z.NavbarBrand,null,r.a.createElement("span",null)),r.a.createElement(z.NavbarToggler,{onClick:this.props.toggleShowSideNav}),r.a.createElement(ae,null)):null}}]),a}(n.Component),oe=Object(ne.a)((function(e){return{activeTask:e.app.activeTask}}),(function(e){return{toggleShowSideNav:function(){return e(re.toggleSideNav())}}}))(le),se=a(41),ie=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).handleToggl=function(){n.props.hideSideNav(),n.setState({isOpen:!n.state.isOpen})},n.state={app_version:window.APP_VERSION||null,isOpen:!1},n.handleToggl=n.handleToggl.bind(Object(se.a)(n)),n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=this;"null"!==this.state.app_version&&setTimeout((function(){e.setState({app_version:window.APP_VERSION||"dev"})}),1e3)}},{key:"render",value:function(){var e="hide-on-small sidebar-fixed";return this.props.showSideNavOnSmallScreens&&(e="sidebar-fixed"),r.a.createElement("div",{className:e},r.a.createElement("a",{href:"#!",className:"logo-wrapper waves-effect"},r.a.createElement("img",{alt:"MDB React Logo",className:"img-fluid",src:"/img/taestitrack.png"})),r.a.createElement(z.ListGroup,{className:"list-group-flush"},r.a.createElement(z.ListGroupItem,{className:"cursor-pointer"},r.a.createElement(P.Link,{to:"/dashboard",onClick:this.handleToggl},r.a.createElement(z.Fa,{icon:"pie-chart",className:"mr-3"}),"Dashboard")),r.a.createElement(z.ListGroupItem,{className:"cursor-pointer"},r.a.createElement(P.Link,{to:"/playbooks",onClick:this.handleToggl},r.a.createElement(z.Fa,{icon:"user",className:"mr-3"}),r.a.createElement("span",null,"Show Playbooks"))),r.a.createElement(z.ListGroupItem,{className:"cursor-pointer"},r.a.createElement(P.Link,{to:"/playbooks/new",onClick:this.handleToggl},r.a.createElement(z.Fa,{icon:"table",className:"mr-3"}),r.a.createElement("span",null,"Create Playbook"))),r.a.createElement(z.ListGroupItem,{className:"cursor-pointer"},r.a.createElement(P.Link,{to:"/logout",onClick:this.handleToggl},r.a.createElement(z.Fa,{icon:"sign-out",className:"mr-3"}),r.a.createElement("a",null,"Sign Out"))),r.a.createElement("hr",null),r.a.createElement("p",{id:"app-version"},"Version : "+this.state.app_version)))}}]),a}(n.Component),ce=Object(ne.a)((function(e){return{showSideNavOnSmallScreens:e.dom.show_sidenav_onsmallscreen}}),(function(e){return{hideSideNav:function(){return e(re.hideSideNav())}}}))(ie),ue=a(103),de=a.n(ue),me=Object(L.o)(function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).signup=function(){n.props.history.push("/register")},n.resetPassword=function(e){e.preventDefault(),n.props.history.push("/password/reset")},n.state={form:{}},n._bind(["change","login"]),n}return Object(I.a)(a,[{key:"change",value:function(e){var t=e.target.name;this.state.form[t]=e.target.value,this.setState(this.state)}},{key:"login",value:function(e){var t=this;e.preventDefault(),window.firebase.auth().signInWithEmailAndPassword(this.state.form.email,this.state.form.password).catch((function(e){var t=e.message;alert(t)})).then((function(e){window.user=e.user,window.FB.registerListeners();var a=atob(de.a.parse(t.props.location.search).redirect);a.length>1?t.props.history.push(a):t.props.history.push("/playbooks"),window.FB.serverTimeStamp()}))}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,{className:"mt-5 text-center"},r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement(z.MDBJumbotron,null,r.a.createElement("div",{className:"form signin-form"},r.a.createElement(z.MDBInput,{name:"email",onChange:this.change,label:"Email"}),r.a.createElement(z.MDBInput,{name:"password",onChange:this.change,label:"Password",type:"password"}),r.a.createElement(z.MDBBtn,{color:"dark-green",onClick:this.login},"Sign In"),r.a.createElement(z.MDBBtn,{color:"blue",onClick:this.signup},"Sign Up"),r.a.createElement("br",null),r.a.createElement("a",{href:"#",onClick:this.resetPassword},"Forgot Password"))))))}}]),a}(x)),pe=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={form:{}},n._bind(["change","save"]),window.firebase.auth().languageCode="en",n}return Object(I.a)(a,[{key:"change",value:function(e){var t=e.target.name,a=e.target.value;this.state.form[t]=a,this.setState(this.state)}},{key:"save",value:function(e){e.preventDefault(),window.firebase.auth().createUserWithEmailAndPassword(this.state.form.email,this.state.form.password).catch((function(e){var t=e.message;alert(t)}))}},{key:"componentDidMount",value:function(){this.recaptcha=new window.firebase.auth.RecaptchaVerifier("captcha"),this.recaptcha.render()}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,{className:"mt-5 text-center"},r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement(z.MDBJumbotron,null,r.a.createElement("div",{className:"form signin-form"},r.a.createElement(z.MDBInput,{name:"email",onChange:this.change,label:"Email"}),r.a.createElement(z.MDBInput,{name:"password",onChange:this.change,label:"Password",type:"password"}),r.a.createElement("div",{id:"captcha"}),r.a.createElement(z.MDBBtn,{color:"dark-green",onClick:this.save},"Sign Up"))))))}}]),a}(x),he=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={form:{}},n._bind(["change","reset"]),window.firebase.auth().languageCode="en",n}return Object(I.a)(a,[{key:"change",value:function(e){var t=e.target.name,a=e.target.value;this.state.form[t]=a,this.setState(this.state)}},{key:"reset",value:function(e){e.preventDefault();var t=window.firebase.auth().sendPasswordResetEmail(this.state.form.email);t.then((function(){alert("password reset Mail sent")})),t.catch((function(e){e.code;var t=e.message;alert(t)}))}},{key:"componentDidMount",value:function(){this.recaptcha=new window.firebase.auth.RecaptchaVerifier("captcha"),this.recaptcha.render()}},{key:"render",value:function(){return r.a.createElement(z.MDBContainer,{className:"mt-5 text-center"},r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement(z.MDBJumbotron,null,r.a.createElement("div",{className:"form signin-form"},r.a.createElement(z.MDBInput,{name:"email",onChange:this.change,label:"Email"}),r.a.createElement("div",{id:"captcha"}),r.a.createElement(z.MDBBtn,{color:"dark-green",onClick:this.reset},"Reset"))))))}}]),a}(x),ke=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={showFormFlag:!1},n._bind(["onAddClick","onDiscardClick","onClickCreateNew","handleUpdateCard","handleUpdateCardTime"]),n}return Object(I.a)(a,[{key:"onDiscardClick",value:function(e){this.setState({showFormFlag:!1,newCard:null})}},{key:"onAddClick",value:function(){this.setState({showFormFlag:!1});var e=this.state.newCard,t=e.estimate.hrs?3600*e.estimate.hrs:0;t+=e.estimate.min?60*e.estimate.min:0,t+=e.estimate.sec?1*e.estimate.sec:0,e.estimate=t,e.created_at=window.firebase.database.ServerValue.TIMESTAMP,e.progress={},window.FB.addNewTask(this.props.playbook,e)}},{key:"onClickCreateNew",value:function(){this.setState({showFormFlag:!0,newCard:{status:"new",estimate:{}}})}},{key:"handleUpdateCard",value:function(e){var t=this.state.newCard;t[e.target.dataset.key]=e.target.value,this.setState({newCard:t})}},{key:"handleUpdateCardTime",value:function(e){var t=this.state.newCard;t.estimate[e.target.dataset.key]=e.target.value,this.setState({newCard:t})}},{key:"renderCreateNewButton",value:function(){return r.a.createElement(z.Row,{style:{margin:"5px 0px 5px 0px"},end:!0},r.a.createElement(z.Col,{md:"5"},r.a.createElement(z.MDBBtn,{color:"green",size:"sm",onClick:this.onClickCreateNew},r.a.createElement(z.MDBIcon,{icon:"plus"}),"Create New")))}},{key:"renderCreateNewForm",value:function(){return r.a.createElement(z.Row,{style:{margin:"5px 0px 5px 0px"}},r.a.createElement(z.Col,null,r.a.createElement(z.Card,null,r.a.createElement(z.CardHeader,{className:"img-fluid"},r.a.createElement(z.MDBBadge,{color:"blue"},"New")),r.a.createElement(z.CardBody,null,r.a.createElement(z.CardTitle,{className:"task-title"},r.a.createElement(z.MDBInput,{label:"Task description",type:"textarea","data-key":"title",name:"title",onChange:this.handleUpdateCard})),r.a.createElement(z.CardText,null,"Estimate : ",r.a.createElement("span",{className:"task task-estimate"},r.a.createElement(z.Row,null,r.a.createElement(z.Col,{size:4},r.a.createElement(z.MDBInput,{className:"new-task-time-input",label:"hh","data-key":"hrs",type:"number",size:"2",min:"0",max:"23",onChange:this.handleUpdateCardTime})),r.a.createElement(z.Col,{size:4},r.a.createElement(z.MDBInput,{className:"new-task-time-input",label:"mm","data-key":"min",type:"number",size:"2",min:"0",max:"59",onChange:this.handleUpdateCardTime})),r.a.createElement(z.Col,{size:4},r.a.createElement(z.MDBInput,{className:"new-task-time-input",label:"ss","data-key":"sec",type:"number",size:"2",min:"0",max:"59",onChange:this.handleUpdateCardTime})))))),r.a.createElement(z.CardFooter,null,r.a.createElement(z.MDBBtn,{color:"red",onClick:this.onDiscardClick},"Discard"),r.a.createElement(z.MDBBtn,{color:"green",onClick:this.onAddClick},"Add")))))}},{key:"render",value:function(){return this.state.showFormFlag?this.renderCreateNewForm():this.renderCreateNewButton()}}]),a}(x),fe=a(52),ve=function(){function e(){Object(A.a)(this,e)}return Object(I.a)(e,[{key:"add",value:function(e,t,a){return{type:"TASK_ADD",description:e,estimate:t,playbookId:a}}},{key:"pause",value:function(e){return{type:"TASK_PAUSE",id:e}}}],[{key:"start",value:function(e,t){return function(a){window.FB.startTask(t,e,(function(){a({type:"TASK_START",task:e})}))}}},{key:"done",value:function(e,t){return function(a){window.FB.markTaskDone(t,e)}}},{key:"delete",value:function(e,t){return function(a){window.FB.deleteTask(t,e)}}},{key:"update",value:function(e,t,a){return function(n){window.FB.updateTask(t,e).then(a)}}}]),e}(),be=a(83),ye=a.n(be),Ee=function(){function e(){Object(A.a)(this,e)}return Object(I.a)(e,null,[{key:"edit",value:function(e,t,a,n){return function(r){window.FB.editLap(e,t,a,(function(e){n()}))}}}]),e}(),ge=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).handleChange=function(e){return function(t){var a={};a[e]=t,n.setState(a)}},n.handleEdit=function(e){return n.setState({editing:!0})},n.handleSave=function(e){var t={};t.key=n.props.lap.key,t.start=n.state.start,t.end=n.state.end,t.note=n.state.note,n.props.editLap(n.props.playbook,n.props.task,t,(function(){n.setState({editing:!1})}))},n.state=Object(fe.a)({editing:!1},n.props.lap),n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.setState({editing:!1})}},{key:"renderDetails",value:function(){this.state;return r.a.createElement(n.Fragment,null,r.a.createElement("div",null,"Start : ",r.a.createElement(Y,{milliseconds:this.state.start})),r.a.createElement("div",null,"End : ",r.a.createElement(Y,{milliseconds:this.state.end})),r.a.createElement("div",null,"Note : ",this.state.note))}},{key:"renderToolBar",value:function(e){var t=this;return r.a.createElement(n.Fragment,null,r.a.createElement(z.MDBBtn,{color:"secondary",onClick:function(){return t.setState({editing:!1},e.toggle)}},"Close"),"done"!==this.props.task.status?this.state.editing?r.a.createElement(z.MDBBtn,{color:"primary",onClick:this.handleSave},"Save"):r.a.createElement(z.MDBBtn,{onClick:this.handleEdit,color:"primary"},"Edit"):null)}},{key:"renderForm",value:function(){var e=this;this.state;return r.a.createElement(n.Fragment,null,r.a.createElement("div",null,"Start : ",r.a.createElement(ye.a,{selected:this.state.start&&new Date(this.state.start),showTimeSelect:!0,onChange:function(t){return e.handleChange("start")(t.getTime())},dateFormat:"dd/MM/yyyy hh:mm aa"})),r.a.createElement("div",null,"End : ",r.a.createElement(ye.a,{selected:this.state.end&&new Date(this.state.end),showTimeSelect:!0,onChange:function(t){return e.handleChange("end")(t.getTime())},dateFormat:"dd/MM/yyyy hh:mm aa"})),r.a.createElement(z.MDBInput,{valueDefault:this.state.note,onChange:function(t){return e.handleChange("note")(t.target.value)},type:"textarea",label:"Note",rows:"3"}))}},{key:"render",value:function(){var e=this,t=this.props;return null!==t.lap&&r.a.createElement(z.MDBModal,{centered:!0,isOpen:!0,size:"md",toggle:function(){return e.setState({editing:!1},t.toggle)}},r.a.createElement(z.MDBModalHeader,{toggle:function(){return e.setState({editing:!1},t.toggle)}},"Lap Details"),r.a.createElement(z.MDBModalBody,null,r.a.createElement("div",null,"Playbook : ",t.playbook.title),r.a.createElement("div",null,"Task : ",t.task.title),this.state.editing?this.renderForm(t):this.renderDetails(t)),r.a.createElement(z.MDBModalFooter,null,this.renderToolBar(t)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{start:t.start||e.lap&&e.lap.start||null,end:t.end||e.lap&&e.lap.end||null,note:t.note||e.lap&&e.lap.note||null}}}]),a}(n.Component),we=Object(R.b)(null,{editLap:Ee.edit})(ge),Te=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).onDelete=function(e){e.preventDefault();var t=n.props.task;n.props.delete(t,n.props.playbook)},n.toggleLaps=function(){n.setState({lapsToggle:!n.state.lapsToggle})},n.onUpdate=function(){var e=Object(fe.a)({},n.props.task);e.title=n.state.taskTitle,n.props.update(e,n.props.playbook,(function(){n.setState({editTask:!1})}))},n.showLapsModel=function(e){return function(t){t.preventDefault(),n.setState({editLap:e})}},n.state={lapsToggle:!1,editLap:null,editTask:!1,taskTitle:e.task.title},n}return Object(I.a)(a,[{key:"onStartProvider",value:function(){var e=this;return function(){e.props.start(e.props.task,e.props.playbook)}}},{key:"onDoneProvider",value:function(){var e=this;return function(){e.props.done(e.props.task,e.props.playbook)}}},{key:"renderControlPanel",value:function(){var e=r.a.createElement(z.MDBBtn,{color:"cyan",size:"sm",onClick:this.onStartProvider()},r.a.createElement(z.MDBIcon,{icon:"play"})),t=r.a.createElement(z.MDBBtn,{color:"green",size:"sm",onClick:this.onDoneProvider()},r.a.createElement(z.MDBIcon,{icon:"stop"})),a=r.a.createElement(z.MDBBtn,{color:"yellow",size:"sm",onClick:this.toggleLaps},r.a.createElement(z.MDBIcon,{icon:"list-alt"}));return"new"===this.props.task.status&&(a=null),"done"===this.props.task.status&&(e=null,t=null),r.a.createElement(z.CardFooter,null,e,t,a)}},{key:"getTimeTaken",value:function(){var e=this.props.task,t=0;if(e.laps)for(var a in e.laps){var n=e.laps[a];n.end&&n.start&&(t+=n.end-n.start)}return t/1e3}},{key:"renderStatus",value:function(e){switch(e){case"new":return r.a.createElement(z.MDBBadge,{color:"blue"},"New");case"paused":return r.a.createElement(z.MDBBadge,{color:"yellow"},"Paused");case"done":return r.a.createElement(z.MDBBadge,{color:"green"},"Done");default:return r.a.createElement(z.MDBBadge,{color:"primary"},e)}}},{key:"renderLaps",value:function(){if(this.state.lapsToggle){var e=[],t=1;for(var a in this.props.task.laps){var n=Object(fe.a)({},this.props.task.laps[a]);n.key=a,n.title=r.a.createElement("div",null,"Worked for ",r.a.createElement(G,{humanize:!0,timeInSeconds:parseInt((parseInt(n.end)-parseInt(n.start))/1e3)})," from ",r.a.createElement(Y,{milliseconds:n.start})," ",n.note&&" on ".concat(n.note),"."),e.push(r.a.createElement("tr",{key:a},r.a.createElement("td",null,r.a.createElement("small",null,r.a.createElement("a",{onClick:this.showLapsModel(n)},r.a.createElement(z.MDBIcon,{icon:"ellipsis-v"})))),r.a.createElement("td",null,r.a.createElement("small",null,t++)),r.a.createElement("td",null,r.a.createElement("small",null,r.a.createElement("a",{onClick:this.showLapsModel(n)},r.a.createElement("em",null,n.title))))))}return r.a.createElement("div",null,r.a.createElement("h4",null,"Laps (",Object.keys(this.props.task.laps).length,")"),r.a.createElement(z.MDBTable,{responsive:!0},e))}}},{key:"renderTitle",value:function(){var e=this;return this.state.editTask?r.a.createElement(z.MDBInput,{label:"Task description",type:"textarea",value:this.state.taskTitle,onChange:function(t){return e.setState({taskTitle:t.target.value})}}):r.a.createElement(n.Fragment,null,this.props.task.title)}},{key:"renderEditButton",value:function(){var e=this;return"done"===this.props.task.status?null:this.state.editTask?r.a.createElement(n.Fragment,null,r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.onUpdate()}},r.a.createElement(z.MDBIcon,{className:"save link-icon",icon:"save"})),r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.setState({editTask:!1})}},r.a.createElement(z.MDBIcon,{className:"dismiss link-icon",icon:"times"}))):r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.setState({editTask:!0})}},r.a.createElement(z.MDBIcon,{className:"edit link-icon",icon:"edit"}))}},{key:"render",value:function(){var e=this,t=this.props.task,a=this.props.playbook;return r.a.createElement(z.Row,{style:{margin:"5px 0px 5px 0px"},className:"task"},r.a.createElement(z.Col,null,r.a.createElement(z.Card,null,r.a.createElement("div",{className:"face front"},r.a.createElement(z.CardHeader,{className:"img-fluid"},this.renderStatus(t.status),r.a.createElement("span",{className:"right top-right-controls"},this.renderEditButton(),r.a.createElement("a",{onClick:this.onDelete},r.a.createElement(z.MDBIcon,{className:"delete link-icon",icon:"trash"})))),r.a.createElement(z.CardBody,null,r.a.createElement(z.CardTitle,{className:"task-title"},this.renderTitle()),r.a.createElement(z.CardText,null,"Estimate : ",r.a.createElement("span",{className:"task task-estimate"},r.a.createElement(G,{humanize:!0,timeInSeconds:t.estimate})),"Time Taken : ",r.a.createElement("span",{className:"task task-estimate"},r.a.createElement(G,{humanize:!0,timeInSeconds:this.getTimeTaken()})),this.renderLaps())),this.renderControlPanel()))),null!==this.state.editLap&&r.a.createElement(we,Object.assign({task:t,playbook:a},{lap:this.state.editLap,toggle:function(){return e.setState({editLap:null})}})))}}]),a}(x),Oe=Object(R.b)((function(e){return{playbook:e.playbooks[e.app.currentPlaybook]}}),(function(e){return{done:function(t,a){e(ve.done(t,a))},start:function(t,a){e(ve.start(t,a))},delete:function(t,a){e(ve.delete(t,a))},update:function(t,a,n){e(ve.update(t,a,n))}}}))(Te),De={val:0,playListLoaded:!1},Be=function(e){Object(_.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).state={isTodoSelected:!0,playbook:null},n.mobileTabToggle=n.mobileTabToggle.bind(Object(se.a)(n)),De.val=0,De.playListLoaded=!1,n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.setState({listener:window.FB.registerPlaybookListener(this.props.match.params.id)})}},{key:"componentWillUnmount",value:function(){window.FB.deRegisterPlaybookListener(this.state.playbook.key,this.state.listener)}},{key:"renderTodo",value:function(){if(!this.state.playbook.tasks)return null;var e=this.state.playbook.tasks;return Object.keys(e).filter((function(t){return"new"===e[t].status||"paused"===e[t].status})).map((function(t){var a=e[t];return a.key=t,r.a.createElement(Oe,{key:t,task:a})}))}},{key:"renderDone",value:function(){if(!this.state.playbook.tasks)return null;var e=this.state.playbook.tasks;return Object.keys(e).filter((function(t){return"done"===e[t].status})).map((function(t){var a=e[t];return a.key=t,r.a.createElement(Oe,{key:t,task:a})}))}},{key:"mobileTabToggle",value:function(){this.setState({isTodoSelected:!this.state.isTodoSelected})}},{key:"render",value:function(){var e=this;return null===this.state.playbook?"Loading playbook ...":r.a.createElement(n.Fragment,null,r.a.createElement(z.MDBContainer,{fluid:!0,className:"d-none d-md-block"},r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,r.a.createElement("h4",null,this.state.playbook.title))),r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,null,this.state.playbook.description)),r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,{size:"12",md:"6",className:"todo"},r.a.createElement("h4",null,"To-Do"),r.a.createElement("div",{className:"spacer-40px"}),r.a.createElement(z.MDBContainer,{fluid:!0,className:"playbook-col todo"},r.a.createElement(ke,{playbook:this.state.playbook}),this.renderTodo())),r.a.createElement(z.MDBCol,{size:"12",md:"6"},r.a.createElement("h4",null,"Done"),r.a.createElement("div",{className:"spacer-60px"}),r.a.createElement(z.MDBContainer,{fluid:!0,className:"playbook-col done"},this.renderDone())))),r.a.createElement(z.MDBContainer,{className:"d-block d-md-none"},r.a.createElement(z.MDBRow,{size:"12"},r.a.createElement(z.MDBCol,null,r.a.createElement("h4",null,this.state.playbook.title),this.state.playbook.description)),r.a.createElement(z.MDBRow,null,r.a.createElement("ul",{className:"nav nav-tabs col-12",id:"myTab",role:"tablist"},r.a.createElement("li",{className:"nav-item col-6"},r.a.createElement("span",{onClick:this.mobileTabToggle,className:this.state.isTodoSelected?"nav-link active":"nav-link"},r.a.createElement("h4",null,"To-Do"))),r.a.createElement("li",{className:"nav-item col-6"},r.a.createElement("span",{onClick:this.mobileTabToggle,className:this.state.isTodoSelected?"nav-link":"nav-link active"},r.a.createElement("h4",null,"Done"))))),r.a.createElement(z.MDBRow,null,r.a.createElement(z.MDBCol,{size:"12"},r.a.createElement("div",{className:"playbook-col"},function(){var t=r.a.createElement(n.Fragment,null,r.a.createElement(ke,{playbook:e.state.playbook}),e.renderTodo()),a=r.a.createElement(n.Fragment,null,e.renderDone());return e.state.isTodoSelected?t:a}())))))}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.playbooks[e.match.params.id]||null;return t&&(De.playListLoaded=!0),{playbook:t}}}]),a}(x),Se=Object(L.o)(Object(R.b)((function(e){return{playbooks:e.playbooks}}),(function(){return{}}))(Be)),Ce=function(e,t,a){return function(){return r.a.createElement("div",{className:"flexible-content page-wrapper"},r.a.createElement("div",{className:"left-panel"},t),r.a.createElement("div",{className:"right-panel"},r.a.createElement("div",{className:"top-nav"},e),r.a.createElement("div",{className:"main-block"},a)))}},Me=function(e){return Ce(r.a.createElement(oe,null),r.a.createElement(ce,null),e)};function Ne(e){return function(){if(window.user)return r.a.createElement(e,null);var t=btoa(window.location.pathname);return r.a.createElement(L.c,{to:"/login?redirect=".concat(t)})}}var je,Pe,Le=Ce(null,null,r.a.createElement(me,null)),Ae=Ce(null,null,r.a.createElement(pe,null)),Ie=Ce(null,null,r.a.createElement(he,null)),_e=Ne(Me(r.a.createElement(W,null))),Fe=Ne(Me(r.a.createElement(Q,null))),Re=Ne(Me(r.a.createElement(ee,null))),xe=Ne(Me(r.a.createElement(Se,null))),ze=Object(L.o)((function(e){return window.firebase.auth().signOut().then((function(){return e.history.push("/login")})),"Logging out..."})),Je=(je=r.a.createElement(P.BrowserRouter,null,r.a.createElement(L.g,null,r.a.createElement(L.d,{path:"/login"},r.a.createElement(Le,null)),r.a.createElement(L.d,{path:"/logout"},r.a.createElement(ze,null)),r.a.createElement(L.d,{path:"/register"},r.a.createElement(Ae,null)),r.a.createElement(L.d,{path:"/password/reset"},r.a.createElement(Ie,null)),r.a.createElement(L.d,{path:"/dashboard"},r.a.createElement(_e,null)),r.a.createElement(L.d,{path:"/playbook/:id"},r.a.createElement(xe,null)),r.a.createElement(L.d,{path:"/playbooks/new"},r.a.createElement(Fe,null)),r.a.createElement(L.d,{path:"/playbooks"},r.a.createElement(Re,null)),r.a.createElement(L.d,{path:"/"},r.a.createElement(_e,null)))),function(){return r.a.createElement(R.a,{store:window.APP_GLOBALS.store},je)}),Ue=function(){function e(){Object(A.a)(this,e)}return Object(I.a)(e,null,[{key:"refresh",value:function(e){return{type:"REFRESH_LOGS",logs:e}}}]),e}(),Ge=function(){function e(){Object(A.a)(this,e),this.db=window.firebase.database()}return Object(I.a)(e,[{key:"addNewPlayBook",value:function(e,t,a){var n=this,r={};!function(e){if(window.user&&window.user.uid){var t=n.db.ref("users/"+window.user.uid+"/playbooks").push();r.userPlabooksEntry=t,e(t)}}(function(l){var o={};o[window.user.uid]="owner";var s={title:e,description:t,users:o,status:"active"},i=n.db.ref("/playbooks/"+l.key);r.playbooksEntry=i,i.set(s).then((function(){l.set(!0),r.playbooksEntry.once("value").then((function(e){a(e)})).catch((function(){return console.log("there is an error")}))}))}.bind(this))}},{key:"getPlaybooks",value:function(){this.db.ref("users/"+window.user.uid+"/playbooks").once("value").then((function(e){})).catch((function(e){return alert(e.message)}))}},{key:"registerListeners",value:function(){window.FB_Listenters=[],window.FB_Listenters[0]=this.db.ref("users/"+window.user.uid+"/playbooks").on("value",this.listenForUserPlaybooks.bind(this)),window.FB_Listenters[1]=this.db.ref("users/"+window.user.uid+"/active-task").on("value",this.listenForActiveTask),window.FB_Listenters[1]=this.db.ref("users/"+window.user.uid+"/logs").on("value",this.listenForLogs)}},{key:"listenForLogs",value:function(e){var t=e.toJSON();window.APP_GLOBALS.store.dispatch(Ue.refresh(t))}},{key:"listenForUserPlaybooks",value:function(e){var t=e.toJSON(),a={};if(null==t)return window.APP_GLOBALS.store.dispatch(X.hydrate(a));var n=Object.keys(t),r=0,l=this.db;!function e(){r<=n.length-1?l.ref("playbooks/"+n[r]).once("value").then((function(n){var r=n.key;t[r]&&((n=n.toJSON()).key=r,a[r]=n),e()})).catch((function(t){console.log(t.message),e()})):window.APP_GLOBALS.store.dispatch(X.hydrate(a)),r++}()}},{key:"listenForActiveTask",value:function(e){var t=e.toJSON();window.APP_GLOBALS.store.dispatch({type:"SET_ACTIVE_TASK",activeTask:t})}},{key:"listenForPlaybook",value:function(e){var t=e.toJSON();null!=t&&(t.key=e.key,t.ref=e.ref,window.APP_GLOBALS.store.dispatch(X.update(t)),window.APP_GLOBALS.store.dispatch({type:"CURRENT_PLAYBOOK",playbook:t}))}},{key:"registerPlaybookListener",value:function(e){return this.db.ref("playbooks/"+e).on("value",this.listenForPlaybook)}},{key:"deRegisterPlaybookListener",value:function(e,t){return this.db.ref("playbooks/"+e).off("value",t)}},{key:"addNewTask",value:function(e,t){this.db.ref("/playbooks/"+e.key+"/tasks").push(t)}},{key:"deleteTask",value:function(e,t){return this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key).remove()}},{key:"markTaskDone",value:function(e,t,a){var n=this;return this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/status").set("done").then((function(){n.endLap(e,t,(function(e,t){return n.updateDoneLog(e,t,a)}))}))}},{key:"updateTask",value:function(e,t){var a=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key);return delete t.key,a.set(t)}},{key:"updateDoneLog",value:function(e,t,a){var n=this.db.ref("users/"+window.user.uid+"/logs/completedTasks"),r=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key),l={playbook:e.title,task:t.title};r.once("value").then((function(e){if("done"===e.child("status").val()){var t=e.child("laps").val(),r=0,o=Number.MAX_SAFE_INTEGER,s=0;for(var i in t)r<t[i].end&&(r=t[i].end),o>t[i].start&&(o=t[i].start),s+=t[i].end-t[i].start;l.started_at=o,l.completed_at=r,l.duration=parseInt(s/1e3),l.estimate=e.child("estimate").val(),l.created_at=e.child("created_at").val()}n.push(l).then((function(){a&&a()}))}))}},{key:"editLap",value:function(e,t,a,n){var r=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/laps/"+a.key),l={};l.start=a.start,l.end=a.end,a.note&&(l.note=a.note),r.set(l).then(n)}},{key:"startLap",value:function(e,t,a){var n=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/laps");n.once("value").then((function(e){var t=e.toJSON(),r=null;if(null===t)return n.push({start:window.firebase.database.ServerValue.TIMESTAMP,end:!1}),a();for(var l in t){var o=t[l];o.key=l,!1===o.end&&(r=o)}return null===r?(n.push({start:window.firebase.database.ServerValue.TIMESTAMP,end:!1}),a()):a()})).catch((function(){return console.log("there is error in starting lap")}))}},{key:"endLap",value:function(e,t,a){var n=this,r=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/laps");r.once("value").then((function(l){var o=l.toJSON(),s=null;if(null===o)return r.push({start:window.firebase.database.ServerValue.TIMESTAMP,end:window.firebase.database.ServerValue.TIMESTAMP}),a(e,t);for(var i in o){var c=o[i];c.key=i,!1===c.end&&(s=c)}return null===s?r.push({start:window.firebase.database.ServerValue.TIMESTAMP,end:window.firebase.database.ServerValue.TIMESTAMP}).then((function(){return a(e,t)})):n.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/laps/"+s.key+"/end").set(window.firebase.database.ServerValue.TIMESTAMP).then((function(){return a(e,t)}))})).catch((function(e){return console.log("there is error in starting lap"+e)}))}},{key:"markTaskOngoing",value:function(e,t){var a=this,n=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/status");return n.once("value").then((function(r){if("new"===r.val()||"paused"===r.val())return n.set("ongoing").then((function(){a.startLap(e,t)}))}))}},{key:"markTaskPaused",value:function(e,t,a){var n=this,r=this.db.ref("/playbooks/"+e.key+"/tasks/"+t.key+"/status");return r.once("value").then((function(l){if("ongoing"===l.val())return r.set("paused").then((function(){n.endLap(e,t,a)}))}))}},{key:"startTask",value:function(e,t){var a=this,n="users/"+window.user.uid+"/active-task";this.db.ref(n).once("value").then((function(r){null===r.toJSON()&&a.db.ref(n).set({task:t.key,playbook:e.key}).then((function(){return a.markTaskOngoing(e,t)}))}))}},{key:"pauseTask",value:function(e,t,a){var n=this,r="users/"+window.user.uid+"/active-task";this.db.ref(r).once("value").then((function(l){null!==l.toJSON()&&n.db.ref(r).set(null).then((function(){return n.markTaskPaused(e,t,a)}))}))}},{key:"doneWithTask",value:function(e,t,a){var n=this,r="users/"+window.user.uid+"/active-task";this.db.ref(r).once("value").then((function(l){null!==l.toJSON()&&n.db.ref(r).set(null).then((function(){return n.markTaskDone(e,t,a)}))}))}},{key:"removePlaybook",value:function(e){var t=this,a="users/"+window.user.uid+"/playbooks/"+e;this.db.ref(a).remove().then((function(){var a="playbooks/"+e;t.db.ref(a).remove().then((function(){var a="users/"+window.user.uid+"/active-task";t.db.ref(a).once("value").then((function(a){var n=a.toJSON();null!==n&&n.playbook===e&&t.db.ref("users/"+window.user.uid+"/active-task").set(null)}))})).catch((function(){return console.error("delete failed")}))})).catch((function(e){console.log("Remove failed: "+e.message)}))}},{key:"serverTimeStamp",value:function(){var e=this,t="users/"+window.user.uid+"/current-time";this.db.ref(t).set(window.firebase.database.ServerValue.TIMESTAMP).then((function(){e.db.ref(t).once("value").then((function(e){window.APP_GLOBALS.TIMESTAMP=parseInt(e.val()/1e3)+2,setInterval((function(){++window.APP_GLOBALS.TIMESTAMP}),1e3)}))}))}}]),e}();window.APP_GLOBALS={store:(Pe={},Object(s.d)(N,Pe,Object(s.a)(j.a)))},window.FB=new Ge,window.firebase.auth().onAuthStateChanged((function(e){e&&(window.user=e,window.FB.registerListeners(),window.FB.serverTimeStamp()),o.a.render(r.a.createElement(Je,null),document.getElementById("root"))}));a(193);"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[105,1,2]]]);
//# sourceMappingURL=main.74518bb6.chunk.js.map